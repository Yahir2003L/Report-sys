---
import { checkPermission } from "@/lib/access-control";


const { user } = Astro.props;

try {
  checkPermission(user, 'user', 'primaria');
} catch (error) {
  if (error instanceof Error && error.message === 'ACCESS_DENIED') {
    return new Response(null, {
      status: 302,
      headers: { Location: '/access-denegado' },
    });
  }
  
  console.error('Error inesperado:', error);
  return new Response(null, {
    status: 500,
    headers: { Location: '/error' },
  });
}
---
<h1>Crear Reporte</h1>
<p>Bienvenido, {user.fullName}</p>